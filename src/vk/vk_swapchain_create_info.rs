// Generated by `scripts/generate_vk.js`

use vk::*;
use std::os::raw::c_char;
use std::ops::Drop;
use std::ptr::null;
use libc::*;

#[repr(C)]
pub struct RawVkSwapchainCreateInfo {
    s_type: RawVkStructureType,
    next: *const c_void,
    flags: RawVkSwapchainCreateFlags,
    surface: RawVkSurface,
    min_image_count: u32,
    image_format: RawVkFormat,
    image_color_space: RawVkColorSpace,
    image_extent: RawVkExtent2D,
    image_array_layers: u32,
    image_usage: RawVkImageUsageFlags,
    image_sharing_mode: RawVkSharingMode,
    queue_family_index_count: u32,
    queue_family_indices: *mut u32,
    pre_transform: RawVkSurfaceTransformFlags,
    composite_alpha: RawVkCompositeAlphaFlags,
    present_mode: RawVkPresentMode,
    clipped: RawVkBool32,
    old_swapchain: RawVkSwapchain,
}

#[derive(Debug)]
pub struct VkSwapchainCreateInfo<'a, 'b> {
    pub flags: VkSwapchainCreateFlags,
    pub surface: &'a VkSurface,
    pub min_image_count: u32,
    pub image_format: VkFormat,
    pub image_color_space: VkColorSpace,
    pub image_extent: VkExtent2D,
    pub image_array_layers: u32,
    pub image_usage: VkImageUsageFlags,
    pub image_sharing_mode: VkSharingMode,
    pub queue_family_indices: Vec<usize>,
    pub pre_transform: VkSurfaceTransformFlags,
    pub composite_alpha: VkCompositeAlphaFlags,
    pub present_mode: VkPresentMode,
    pub clipped: bool,
    pub old_swapchain: Option<&'b VkSwapchain>,
}

impl<'a, 'b> VkFrom<VkSwapchainCreateInfo<'a, 'b>> for RawVkSwapchainCreateInfo {
    
    fn vk_from(value: &VkSwapchainCreateInfo) -> Self {
        unsafe {
            Self {
                s_type: VkFrom::vk_from(&VkStructureType::SwapchainCreateInfo),
                next: null(),
                flags: VkFrom::vk_from(&value.flags),
                surface: VkFrom::vk_from(value.surface),
                min_image_count: value.min_image_count,
                image_format: VkFrom::vk_from(&value.image_format),
                image_color_space: VkFrom::vk_from(&value.image_color_space),
                image_extent: VkFrom::vk_from(&value.image_extent),
                image_array_layers: value.image_array_layers,
                image_usage: VkFrom::vk_from(&value.image_usage),
                image_sharing_mode: VkFrom::vk_from(&value.image_sharing_mode),
                queue_family_index_count: value.queue_family_indices.len() as u32,
                queue_family_indices: copy_as_c_array(&value.queue_family_indices.iter().map(|x| *x as u32).collect()),
                pre_transform: VkFrom::vk_from(&value.pre_transform),
                composite_alpha: VkFrom::vk_from(&value.composite_alpha),
                present_mode: VkFrom::vk_from(&value.present_mode),
                clipped: VkFrom::vk_from(&value.clipped),
                old_swapchain: match value.old_swapchain {
                    Some(raw) => VkFrom::vk_from(raw),
                    None => VK_NULL_HANDLE
                },
            }
        }
    }
}

impl Drop for RawVkSwapchainCreateInfo {
    
    fn drop(&mut self) {
        unsafe {
            free_c_array(self.queue_family_indices);
        }
    }
}